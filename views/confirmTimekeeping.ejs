<!-- Header -->
<%- include('includes/header.ejs') %> <% if (listStaff.length > 0) { %>
<!-- Select user input -->
<div>
  <div class="form-group" style="margin: 1rem; display: inline">
    <label for="user">Nhân viên:</label>
    <select
      name="user"
      id="user"
      class="form-control"
      style="width: 25rem; margin-left: 1rem; display: inline"
    >
      <% for (let staff of listStaff) { %> <% if (selectedUser._id.toString()
      === staff._id.toString()) { %>
      <option value="<%= staff._id %>" selected>
        <%= staff.name %> -- <%= staff.email %>
      </option>
      <% } else { %>
      <option value="<%= staff._id %>">
        <%= staff.name %> -- <%= staff.email %>
      </option>
      <% } %> <% } %>
    </select>
  </div>
  <div class="form-group" style="margin: 1rem; display: inline">
    <label for="month">Tháng:</label>
    <input
      type="number"
      max="12"
      min="1"
      name="month"
      id="month"
      value="<%= month %>"
      style="width: 5rem; margin: 1rem; display: inline"
      class="form-control"
    />
  </div>
  <div class="form-group" style="margin: 1rem; display: inline">
    <label for="year">Năm:</label>
    <input
      type="number"
      name="year"
      id="year"
      value="<%= year %>"
      style="width: 5rem; margin: 1rem; display: inline"
      class="form-control"
    />
  </div>
  <button class="btn btn-primary" onclick="filterConfirmTimekeeping()">
    Filter
  </button>
  <a
    class="btn btn-success"
    href="/confirmTkp?user=<%= selectedUser._id %>&month=<%= month %>&year=<%= year %>"
  >
    Confirm
  </a>
</div>
<!-- Timekeeping -->
<div class="container-fluid">
  <div class="row">
    <% for (let tkp of timekeepings) { %>
    <div class="col-12 col-md-4 col-lg-3 col-xl-2 ml-1 mr-1">
      <div class="card" style="height: 26rem">
        <div class="card-body">
          <p>
            Ngày: <%= tkp.timekeeping.createdAt.getDate() %>/<%=
            tkp.timekeeping.createdAt.getMonth() + 1 %>/<%=
            tkp.timekeeping.createdAt.getFullYear() %>
          </p>
          <p>
            Bắt đầu: <%= tkp.timekeeping.createdAt.getHours() %>:<%=
            tkp.timekeeping.createdAt.getMinutes() %>
          </p>
          <p>
            Kết thúc: <% if (tkp.timekeeping.status) { %> -- <% } else { %> <%=
            tkp.timekeeping.createdAt.getHours() %>:<%=
            tkp.timekeeping.createdAt.getMinutes() %> <% } %>
          </p>
          <p>Nơi làm việc: <%= tkp.timekeeping.workplace %></p>
          <p>Giờ làm thêm: <%= tkp.overTime %></p>
          <p>
            Tổng số giờ: <%= tkp.workedTime.hours %>:<%= tkp.workedTime.minutes
            %>
          </p>
          <% if (tkp.totalTime) { %>
          <p>Giờ làm trong ngày: <%= tkp.totalTime %></p>
          <% } %>
        </div>
        <% if (!tkp.timekeeping.confirm && !tkp.timekeeping.status) { %><button
          type="button"
          class="btn btn-danger"
          style="width: 10rem; margin-left: auto; margin-right: auto"
          data-bs-toggle="modal"
          data-bs-target="#modal"
          onclick="clickDeleteTimekeepingButton('<%= tkp.timekeeping._id %>', '<%= selectedUser._id %>', '<%= month %>', '<%= year %>')"
        >
          Xóa
        </button>
        <% } %>
      </div>
    </div>
    <% } %>
  </div>
</div>
<% } else { %>
<div
  class="width: 20rem; margin-left: auto; margin-right: auto; text-align: center;"
></div>
<% } %>
<!-- Modal -->
<div
  class="modal fade"
  id="modal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          Xóa điểm danh giờ làm
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" id="model-body">
        Bạn chắc chắn muốn xóa?
        <form
          action="/deleteTimekeeping"
          method="post"
          id="deleteTimekeepingForm"
        >
          <input type="hidden" name="tkpId" id="tkpId" />
          <input type="hidden" name="url" id="url" />
        </form>
      </div>
      <div class="modal-footer">
        <button
          type="submit"
          form="deleteTimekeepingForm"
          class="btn btn-danger"
        >
          Xóa
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Footer -->
<%- include('includes/footer.ejs') %>
